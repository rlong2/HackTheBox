http://overthewire.org/wargames/natas/
https://jhalon.github.io/over-the-wire-natas1/
 
 Natas teaches the basics of serverside web-security.

Each level of natas consists of its own website located at http://natasX.natas.labs.overthewire.org, where X is the level number. There is no SSH login. To access a level, enter the username for that level (e.g. natas0 for level 0) and its password.

Each level has access to the password of the next level. Your job is to somehow obtain that next password and level up. All passwords are also stored in /etc/natas_webpass/. E.g. the password for natas5 is stored in the file /etc/natas_webpass/natas5 and only readable by natas4 and natas5.

Start here:

Username: natas0
Password: natas0
URL:      http://natas0.natas.labs.overthewire.org

natas0:
You can find the password for the next level on this page. 

Solution: Inspect Element
The password for natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto 

natas1: 
You can find the password for the next level on this page, but rightclicking has been blocked! 

Solution: Right click worked, inspect element also accessible w/ F12
The password for natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi 

natas2:
There is nothing on this page 

Solution: Inspect element, shows <img src="files/pixel.png">
We can add /files to the end of the URL to reveal more files.
http://natas2.natas.labs.overthewire.org/files/
users.txt
# username:password
alice:BYNdCesZqW
bob:jw2ueICLvT
charlie:G5vCxkVV3m
natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14
eve:zo4mJWyNj2
mallory:9urtcpzBmH

natas3:
There is nothing on this page 

Solution: Inspect Element has clue:
There is nothing on this page
<!--No more information leaks!! Not even Google will find it this time...-->
This is a reference to robots.txt (more at http://www.robotstxt.org/)
Append /robots.txt to the url
http://natas3.natas.labs.overthewire.org/robots.txt
User-agent: *
Disallow: /s3cr3t/
Append /s3cr3t to URL:
http://natas3.natas.labs.overthewire.org/s3cr3t/
users.txt
natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ

natas4:
Access disallowed. You are visiting from "" while authorized users should come only from "http://natas5.natas.labs.overthewire.org/" 

Solution: We need to spoof a proxy

Burpsuite > Proxy > Options
Proxy Listener should be set to 127.0.0.1:8080

Firefox > enable FoxyProxy (use proxy Burp for all URLS)

Reload the URL

Burpsuite > Proxy > Intercept
GET /index.php HTTP/1.1
Host: natas4.natas.labs.overthewire.org
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://natas4.natas.labs.overthewire.org/
Cookie: __cfduid=d932546d0a76d6c5d413365ee7452c2291559513158
DNT: 1
Authorization: Basic bmF0YXM0Olo5dGtSa1dtcHQ5UXI3WHJSNWpXUmtnT1U5MDFzd0Va
Connection: close
Upgrade-Insecure-Requests: 1

The Referer is natas4, change it to natas 5:
Referer: http://natas5.natas.labs.overthewire.org/

Burp > Forward

Access granted. The password for natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq  

natas5:
Access disallowed. You are not logged in

Solution: Let's try and intercept with burp again!

GET / HTTP/1.1
Host: natas5.natas.labs.overthewire.org
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: __cfduid=d932546d0a76d6c5d413365ee7452c2291559513158; loggedin=0
DNT: 1
Authorization: Basic bmF0YXM1OmlYNklPZm1wTjdBWU9RR1B3dG4zZlhwYmFKVkpjSGZx
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

change loggedin=0 to loggedin=1 and forward it!

Access granted. The password for natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1

natas6:
There is a textbox that says 'input secret' and an option to view source code.

<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "<censored>" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">

<?

include "includes/secret.inc";

    if(array_key_exists("submit", $_POST)) {
        if($secret == $_POST['secret']) {
        print "Access granted. The password for natas7 is <censored>";
    } else {
        print "Wrong secret";
    }
    }
?>

<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
